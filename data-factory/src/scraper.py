import re
from pathlib import Path

import polars as pl
import requests
from bs4 import BeautifulSoup

DATA_PATH = Path("data").absolute()
url = "https://katalog.burgerbib.ch/deskriptorensuche.aspx"
desk_df = pl.read_csv(DATA_PATH / "input" / "personendeskriptoren.csv", separator=";", columns=["ID-Name", "ID-Nr."])
personendeskriptoren_zusatz_csv = DATA_PATH / "input" / "personendeskriptoren_zusatz.csv"

if personendeskriptoren_zusatz_csv.exists():
	print("File personendeskriptoren_zusatz.csv already exists. Delete it if you want to begin scraping.")
	exit(1)

with open(personendeskriptoren_zusatz_csv, mode="w") as f:
	f.write("desk_id,role,entity_name,entity_id\n")

for row in desk_df.rows(named=True):

	df = pl.DataFrame()
	print(str(row["ID-Nr."]) + ': ' + row["ID-Name"])

	desk_name = re.findall(r".+(?=\(Personen\\NatÃ¼rliche Personen\\.+\))", row["ID-Name"])[0]
	desk_id = row["ID-Nr."]

	payload = {
	    "ctl00$RadScriptManager1": "ctl00$cphMainArea$updDeskriptorensuche|ctl00$cphMainArea$cmdSuchen",
	    "ctl00_RadScriptManager1_TSM": ";;System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35:en-US:d20f15a2-81e5-4f24-80b9-9fe501a4ce09:ea597d4b:b25378d2;Telerik.Web.UI:en-US:366ce917-c5cd-4c60-b5c7-0560a9bf3282:16e4e7cd:365331c3:24ee1bba:ed16cbdc:33715776:58366029:e330518b:2003d0b8:c128760b:1e771326:88144a7a:c8618e41:1a73651d:333f8d94;",
	    "ctl00$cphMainArea$cboThesaurus": "10000",
	    "ctl00$cphMainArea$cboVergleichsoperator": "3",
	    "ctl00$cphMainArea$txtBezeichnung": desk_name,
	    "ctl00_cphMainArea_rgrdListe_ClientState": "",
	    "ctl00_radMenu_ClientState": "",
	    "__LASTFOCUS": "",
	    "__EVENTTARGET": "",
	    "__EVENTARGUMENT": "",
	    "__VIEWSTATE": "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",
	    "__VIEWSTATEGENERATOR": "123C9B61",
	    "__SCROLLPOSITIONX": "0",
	    "__SCROLLPOSITIONY": "0",
	    "__PREVIOUSPAGE": "5nzeIQ2GAPLU6wLS2ZSC5p1hRX_a8NO6TLmbRidcxXRfqwRHlGUF3b7HfxUd6LbgJog_KGm3O_gtm4XuSPkuTXt9zpcMyvj_zR9QUHAiYs01",
	    "__EVENTVALIDATION": "Zfo1o04goUdw07mx1vXc9OjQ6/1HamJMHXYQ2oXgc4dL1ugWYFUF2T064fUYYAJLYtdhdQbXAtIiHO79PTQn6qbhUzfUBJqTLNtWeCdO5CRcmXGi0+K0Hc+PtA2DLTOf4NyVQht2O45r0gMemPPhcpoTmeF5WIBOFKDwhShvN156H8pB9xyPuabYcr0jC2uUwzDDJ+nLiJSwEogSclBuqPiF3Xl3q39xARuBOwQHWbrIrdK7l7L1I4a+UFfxNPkokZ0rn4ueyfUcZ5qH1ONRrDXnSQm/W7fDBJvsL67qs6GtakRUDd5coYFRYZI3iyhIlRSykqdfh0DKktASLGWCiX4/P8hC3Q7p2u81ViWtSWK7+veaG6VVW6hrwTifZzsppfghU+8FPze/uRIIiyljrkGTMsHCzUCLEl7YOGA3GuOFo8C7/QT/jhbbvsycp8/4LJ/hZXSG7zrD4m4cQExwAeAJYoj+v3RHuYd4/XdGrr5Z7Lqc9nKaNbzsqqI9vBBFPwH5dsF2abfo7GGu9Amqool/NnoCo0uHMw3mBsIKqptpOCLGpRYwsXLQrz3xHEXmAbqvOmyeR5EPDyWlZ0HRYtrYP8AAlTNfFvyjjmLDA8mkq57YRJa3aGorK9VSvFIL",
	    "__ASYNCPOST": "true",
	    "ctl00$cphMainArea$cmdSuchen": "Suchen"
	}

	headers = {
	    "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0",
	    "Accept": "*/*",
	    "Accept-Language": "de,it;q=0.8,en-US;q=0.6,en;q=0.4,fr;q=0.2",
	    "Accept-Encoding": "gzip, deflate, br, zstd",
	    "X-Requested-With": "XMLHttpRequest",
	    "X-MicrosoftAjax": "Delta=true",
	    "Cache-Control": "no-cache",
	    "Content-Type": "application/x-www-form-urlencoded; charset=utf-8",
	    "Origin": "https://katalog.burgerbib.ch",
	    "DNT": "1",
	    "Connection": "keep-alive",
	    "Referer": "https://katalog.burgerbib.ch/deskriptorensuche.aspx",
	    "Cookie": "ASP.NET_SessionId=il1vnhjkehgthc4clp4cimzk",
	    "Sec-Fetch-Dest": "empty",
	    "Sec-Fetch-Mode": "cors",
	    "Sec-Fetch-Site": "same-origin",
	    "Sec-GPC": "1",
	    "Priority": "u=0",
	    "content-type": "application/x-www-form-urlencoded"
	}

	response = requests.post(url, data=payload, headers=headers)

	html_doc = response.text

	soup = BeautifulSoup(html_doc, 'html.parser')
	deskRelations = soup.select(".DescriptorLinkTitle")

	if len(deskRelations) > 0:
		for el in deskRelations:
			if len(el.select(".DescriptorRole")) > 0:
				role = el.select(".DescriptorRole")[0].contents

			anchor = el.select("a")[0]
			entity_name = anchor.contents
			entity_id = re.findall(r"(?<=deskriptordetail\.aspx\?Id=)\d{1,15}", anchor["onclick"])
			entry = pl.DataFrame({"desk_id" : desk_id, "role" : role, "entity_name": entity_name, "entity_id": entity_id})
			df = pl.concat([df, entry], how="diagonal")

	with open(personendeskriptoren_zusatz_csv, mode="a+") as f:
		df.write_csv(f, include_header=False)